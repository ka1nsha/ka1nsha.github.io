<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="google" value="notranslate"/>
<meta name="location" content="tÃ¼rkiye, tr, turkey"/>
<meta name="language" content="tr-TR"/>
<meta name="geo.region" content="TR"/>
<meta name="geo.position" content="38.963745;35.243322"/>
<meta name="ICBM" content="38.963745, 35.243322"/>
<meta name ="contactcountry" content="TR">

    <title> 0x656e | Haram Detector</title>
  	<link href="/theme/css/baba.css" rel="stylesheet">
<link href="/theme/css/yapiskan.css" rel="stylesheet">
<link href="/theme/css/baba2.css" rel="stylesheet">
	  <link href="/theme/css/bootstrap.css" rel="stylesheet">
	   <script src="/theme/js/jquery.min.js"></script>

    <script src="/theme/js/bootstrap.min.js"></script>


  </head>
  <body>
    <div class="container">
    <div class="page-header">

  <a href="index.html"><h1>0x656e | Haram Detector </h1></a>

      <h1>
		<small>				<span class="label label-default">#Canyoupwn</span>
				<span class="label label-default">#Genel</span>
				<span class="label label-default">#Python</span>
				</small>
	  </h1>
    </div>


<div class="page-header">
	<h2>TR-IPTables</h2><br>
Cuma, Temmuz 15, 2016</div>

<p><h1><strong> IPTables Nedir ? </strong></h1>
<p>Kernel bazÄ±nda Ã§alÄ±ÅŸan aÄŸ paketlerini inceleyebileceÄŸimiz mÃ¼dahalede bulunabileceÄŸimiz,Linux Ã¼zerinde Ã§alÄ±ÅŸan bir gÃ¼venlik duvarÄ±( ateÅŸ duvarÄ± (firewall))dÄ±r.OldukÃ§a kullanÄ±ÅŸlÄ± bir araÃ§tÄ±r kendisi.Linux Ã¼zerinde ki hangi tool/yazÄ±lÄ±m deÄŸil ki ?</p>
<p><img alt="iptables1" src="images/resim1.png" />  </p>
<h1>Bilinmesi gereken komutlar &amp; kavramlar</h1>
<ul>
<li>ACCEPT : Gelen giden paketleri kabul etmek iÃ§in kullanÄ±lÄ±r.</li>
<li>DROP : Gelen giden paketleri dÃ¼ÅŸÃ¼rmek iÃ§in kullanÄ±lÄ±r.</li>
<li>REJECT : Gelen giden paketleri reddetmek iÃ§in kullanÄ±lÄ±r.Dropâ€™dan farkÄ± kullanÄ±cÄ±ya bunun hakkÄ±nda bilgi verilir.</li>
<li>FORWARD : Gelen giden paketleri yÃ¶nlendirmek iÃ§in kullanÄ±lÄ±r.</li>
<li>INPUT : Gelen paketler iÃ§in kullanÄ±lÄ±r.</li>
<li>OUTPUT : Giden paketler iÃ§in kullanÄ±lÄ±r.  </li>
</ul>
<h2>Biraz pratik</h2>
<p>SÄ±fÄ±r bir iptables ayarlarÄ±na bir gÃ¶z atalÄ±m isterseniz.</p>
<div class="highlight"><pre><span></span>iptables -L -n --line-numbers
</pre></div>


<p><img alt="iptables2" src="images/resim2.png" />  </p>
<p>Tam halini gÃ¶rmek iÃ§in : <a href="https://github.com/ka1nsha/iptables/blob/master/defaultrules.txt">default</a><br />
<em> -L : KurallarÄ± listeler
</em> -n : Burada ip ve portlarÄ±nÄ± bize gÃ¶stermesini istediÄŸimizi belirtiyoruz.DNS isim Ã§Ã¶zÃ¼mlemesi kullanmaz bu yÃ¼zden hÄ±zlÄ± bir ÅŸekilde listeleme yapar.
* --line-numbers :KurallarÄ± kural tipine gÃ¶re satÄ±r numaralarÄ±yla birlikte gÃ¶sterir.
Bir ip adresini drop edelim isterseniz.Åuan elimde web for pentesterÄ±n imajÄ± var.Hemen ip almasÄ±nÄ± saÄŸlayalÄ±m.  </p>
<p><img alt="iptables3" src="images/resim4.png" /></p>
<p>GÃ¶rdÃ¼ÄŸÃ¼nÃ¼z gibi 192.168.1.42 ipâ€™sini almÄ±ÅŸ.  </p>
<p><img alt="iptables4" src="images/resim5.png" />  </p>
<div class="highlight"><pre><span></span>iptables -I OUTPUT -d 192.168.1.42 -j DROP
</pre></div>


<p>Bu kodu ÅŸimdi aÅŸama aÅŸama gÃ¶relim<br />
<em> -I : Insert kelimesinin ilk harfi yani burada kural eklemek istediÄŸimizi sÃ¶ylÃ¼yoruz.
</em> OUTPUT : VerdiÄŸimiz ip adresine veri gÃ¶nderimini engellesin.
<em> -d : Destination kelimesinin ilk harfidir.Yani hedefi 192.168.1.42 olan paketleri engelle.
</em> -j : Jump kelimesinin kÄ±saltmasÄ± olarak kullanÄ±lmÄ±ÅŸ.Kural iÃ§in hedef gÃ¶steriliyor burda.Yani bu kurala uyan paket drop edilsin ÅŸeklinde hikayeleÅŸtirilebilir sanÄ±rÄ±m.
Åimdide bir domain engelleyelim isterseniz.  </p>
<div class="highlight"><pre><span></span>iptables -I OUTPUT -d https://www.canyoupwn.me -j DROP
</pre></div>


<p><img alt="iptables5" src="images/resim6.png" /> <br />
Ä°yi hoÅŸ gÃ¼zel biz engelliyoruz ama lazÄ±m oldu bunu kaldÄ±rmak istedik o zaman nasÄ±l yapacaÄŸÄ±z ?</p>
<p>O zaman ilk Ã¶nce ÅŸÃ¶yle komut gireceÄŸiz.  </p>
<div class="highlight"><pre><span></span>iptables -L -n --line-number | grep â€œipadresiâ€
</pre></div>


<p>Åaka ÅŸaka evet bu yÃ¶ntemi de kullanabilirsiniz ama kurallarÄ±nÄ±z Ã§oÄŸaldÄ±ÄŸÄ±n da bu bir sorun olacak.  </p>
<div class="highlight"><pre><span></span>iptables -L OUTPUT -n --line-number
</pre></div>


<p>Bu ÅŸekilde eklediÄŸiniz kurallarÄ± gÃ¶rebiliyorsunuz.â€â€“line-numberâ€ komutunu verdik ki silerken satÄ±r satÄ±r silmemizde bize kolaylÄ±k saÄŸlasÄ±n diye.</p>
<p>Silmek iÃ§in aÅŸaÄŸÄ±da ki komut yeterlidir.  </p>
<div class="highlight"><pre><span></span>iptables -D OUTPUT 1
</pre></div>


<p>Kodumuza daha yakÄ±ndan bakalÄ±m.<br />
<em> -D : Deleteâ€™in ilk harfi.Yani silmek istediÄŸimizi belirtiyoruz.
</em> OUTPUT : Ã‡Ä±kÄ±ÅŸ yapan paketleri engellemek istediÄŸimizi belirtiyoruz.
* 1 : 1.NumaralÄ± satÄ±r demektir.  </p>
<p><img alt="iptables6" src="images/resim7.png" /></p>
<p>Åu ana kadar hep engellerken -d parametresini kullandÄ±k.Ä°sterseniz sourceâ€™un ilk harfi olan -s i kullanabilirsiniz.Bu da ÅŸu anlama gelir.ÅÃ¶yle Ã¶rnekle aÃ§Ä±klayalÄ±m.  </p>
<div class="highlight"><pre><span></span>iptables -I INPUT -s 192.168.1.42 -j REJECT
</pre></div>


<p>Burada kaynaÄŸÄ± yani bize paket gÃ¶nderen 192.168.1.42 olur ise onu reddet diyoruz.</p>
<p>IPTables ile istersek belirli portalara gelen istekleri veya giden istekleri de engelleyebiliyoruz.Mesela bir ÅŸirkette Ã§alÄ±ÅŸtÄ±ÄŸÄ±mÄ±zÄ± dÃ¼ÅŸÃ¼nelim ve 80 portunun Ã§Ä±kÄ±ÅŸÄ±nÄ± engelleyelim ama giriÅŸi olsun.  </p>
<div class="highlight"><pre><span></span>iptables -I OUTPUT -p tcp --dport 80 -j DROP
</pre></div>


<p>Bu ÅŸekilde engelleyebiliyoruz.Ama bilirsiniz uzak bir Ã¼lkede telekom firmasÄ± da bu ÅŸekilde 3 ay boyunca borcunuzu Ã¶demediÄŸiniz takdirde 80 portunu kapatÄ±yordu fakat bir sorun vardÄ± https Ã¼zerinden internete ( yavaÅŸda olsa ) Ã§Ä±kabiliyorduk.Ä°ÅŸte yukarÄ±da yazdÄ±ÄŸÄ±mÄ±z kod ile biz de bÃ¶yle bir artÄ±k aÃ§Ä±k mÄ±  dersiniz ne dersiniz ona sebebiyet verdik :).Burada â€“dport yerine â€“sport da kullanarak source port ( kaynak port ) engelleyebilirsiniz.</p>
<p>AslÄ±nda bu ÅŸekilde kiÅŸisel bilgisayarÄ±nÄ±zda bir kod ile bunu saÄŸlar iseniz ssl sertifikasÄ± olmayan siteye girmemiÅŸ olursunuz.</p>
<p>Ä°sterseniz ÅŸimdide bize ping atanlarÄ± engelleyelim ne dersiniz ? Yani sadece ping atmalarÄ±nÄ± engelleyeceÄŸiz diÄŸer her iÅŸlevi yapabilicekler.( FiÅŸi Ã§ekmekten iyidir ğŸ˜› )  </p>
<div class="highlight"><pre><span></span>iptables -I INPUT -p icmp --icmp-type echo-reply -j DROP
</pre></div>


<p>EÄŸer bizden bir ping Ã§Ä±kmasÄ±n istiyorsanÄ±z.</p>
<div class="highlight"><pre><span></span>iptables -I OUTPUT -p icmp --icmp-type echo-request -j DROP
</pre></div>


<p><img alt="iptables7" src="images/resim8.png" />  </p>
<p>Genel anlamda aslÄ±nda iptables Ä±n tÃ¼m argÃ¼manlarÄ±na deÄŸindik.DeÄŸiÅŸek tek ÅŸey ipâ€™ler ve protokoller ( tcp / udp ) . BahsetmediÄŸimiz birkaÃ§ ÅŸey kaldÄ± bunlarda interface seÃ§mek,load-balancing,time limit ve port yÃ¶nlendirme.</p>
<p>Ä°nterface seÃ§imi :</p>
<h6>INPUT interface:</h6>
<div class="highlight"><pre><span></span>iptables -I OUTPUT -d 192.168.1.43 -i wlan1 -j DROP
</pre></div>


<p>Kod tamamen Ã¶rnek amaÃ§lÄ±dÄ±r.Burada -i input interface(Paketin alÄ±ndÄ±ÄŸÄ± arayÃ¼z) anlamÄ±na gelir.</p>
<h6>OUTPUT interface</h6>
<div class="highlight"><pre><span></span>iptables -I OUTPUT -d 192.168.1.43 -o wlan1 -j ACCEPT
</pre></div>


<p>Burada -o output interface ( Paketin gÃ¶nderildiÄŸi arayÃ¼z )  anlamÄ±na geliyor.</p>
<h5>Time-limit:</h5>
<p>Bu kodumuzda ise paketlerin alÄ±nma veya yollanma sÄ±klÄ±ÄŸÄ±nÄ± belirleyebiliyoruz.</p>
<p>Kodumuza ÅŸÃ¶yle birÅŸey eklerisek yeterli gelicektir.</p>
<div class="highlight"><pre><span></span>iptables -m limit --limit sÄ±klÄ±k/zaman(Hour veya Second cinsinden )
iptables -m limit --limit 10/5s -j DROP
</pre></div>


<h6>Load-Balancing ( yÃ¼k dengeleme ) :</h6>
<p>BazÄ± sistemlerde yÃ¼k dengelemeye ihtiyaÃ§ duyulabilir ki duyulmasÄ± da gerekir aksi takdirde yÃ¼k daÄŸÄ±tÄ±mÄ± olmadÄ±ÄŸÄ± zaman sistemin Ã§alÄ±ÅŸmasÄ±nda sÄ±kÄ±ntÄ±lar meydana gelecektir.Ä°ÅŸte bu gibi durumlar iÃ§inde iptables da argÃ¼manlarÄ±mÄ±z bulunuyor.</p>
<div class="highlight"><pre><span></span>iptables -I PREROUTING -p tcp --dport 80 -j DNAT --to-destination 192.168.1.1
iptables -I PREROUTING -p tcp --dport 80 -j DNAT --to-destination 192.168.1.2
</pre></div>


<p>Burada hedefi 80 olan tÃ¼m paketleri iki sunucu arasÄ±nda paylaÅŸtÄ±rdÄ±k.</p>
<h6>Port yÃ¶nlendirme :</h6>
<div class="highlight"><pre><span></span>iptables -t NAT -I PREROUTING -p tcp -d 192.168.1.5 --dport 500 -j DNAT --to 192.168.1.100:300
</pre></div>


<p>Burada -t argÃ¼manÄ± table ( tablo ) dan gelmektedir.Yani nat tablosuna ekliyoruz bu kuralÄ±.</p>
<p>Burada hedefi 192.168.1.5:500 olan bir isteÄŸi 192.168.1.100:300 e yÃ¶nlendirdik.</p>
<p>Herhangi bir yerde hata gÃ¶rÃ¼rseniz bildirmekten Ã§ekinmeyiniz teÅŸekkÃ¼r ederim.</p>

</p>

<div id="disqus_thread"></div>
<script>
    
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        
        s.src = '//0x656e.disqus.com/embed.js';
        
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

<h1>

  <small><center>Helal siteler<br><br>
          <a href="https://mertcangokgoz.com/"><span class="label label-default">#Mertcan GÃ¶kgÃ¶z</span></a>
          <a href="https://onur.im/"><span class="label label-default">#Onur Aslan</span></a>
          <a href="http://www.omeripek.com.tr/"><span class="label label-default">#Ã–mer Ä°pek</span></a>
          <a href="https://www.ceyhanmolla.com/"><span class="label label-default">#Ceyhan Molla</span></a>
          <a href="http://furkankalkan.com/"><span class="label label-default">#Furkan Kalkan</span></a>
          <a href="https://canyoupwn.me"><span class="label label-default">#Canyoupwn.me</span></a>
</center>
          </small>
</h1>

      </div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44262671-1', 'auto');
  ga('send', 'pageview');

</script><footer id="footer">
      <div class="col-xs-8 col-xs-offset-2 top-space">
      <p class="text-center">
      Theme based : <a href="http:\\ha.cker.io">ha.cker.io</a> , Jinja coded by :0x6 <br>
	Thanks babayarisi
      </p>
      </div>



    </footer>